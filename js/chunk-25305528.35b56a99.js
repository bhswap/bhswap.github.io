(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-25305528"],{"51f9":function(t,e,a){"use strict";a("5915")},5915:function(t,e,a){},cc0f:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"participate-pledge"},[e("div",{staticClass:"input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.amount,expression:"amount"}],attrs:{type:"number",placeholder:t.$t("participatePledge.text1")},domProps:{value:t.amount},on:{input:function(e){e.target.composing||(t.amount=e.target.value)}}}),e("van-button",{on:{click:t.allIn}},[t._v(t._s(t.$t("participatePledge.text2")))])],1),e("div",{staticClass:"balance"},[e("span",[t._v(t._s(t.$t("participatePledge.text3"))+" "),e("span",[t._v(t._s(t.balances.toFixed(4)))])]),e("router-link",{directives:[{name:"show",rawName:"v-show",value:"BoardofDirectors"!==this.showPopup,expression:"this.showPopup !== 'BoardofDirectors'"}],attrs:{to:""}},[t._v(t._s(t.$t("participatePledge.text4")))])],1),e("van-button",{directives:[{name:"show",rawName:"v-show",value:"none"===t.transactionState,expression:"transactionState === 'none'"}],staticClass:"double-button",on:{click:t.deposit}},[t._v(t._s(t.btnText))]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:"none"!==t.transactionState,expression:"transactionState !== 'none'"}],staticClass:"double-button",attrs:{loading:"","loading-text":t.btnText}})],1)},o=[],i=(a("e7e5"),a("d399")),n=(a("66b9"),a("b650")),r=a("2f62"),c={components:{[n["a"].name]:n["a"]},data(){return{amount:"",balance:0,allowance:"0".toBN(),transactionState:"none",id:null,lpbalance:0,bodbalance:0,lpallowance:"0".toBN(),bodallowance:"0".toBN()}},computed:{...Object(r["b"])(["showPopup"]),btnText(){if(this.allowance.lt(this.amount))return this.$t("participatePledge.text5");switch(this.transactionState){case"approving":return this.$t("participatePledge.text6");case"trading":return this.$t("participatePledge.text7");default:return this.$t("participatePledge.text8")}},balances(){return"BoardofDirectors"==this.showPopup?this.balance=this.bodbalance:this.balance=this.lpbalance}},created(){this.$contracts&&this.init()},methods:{allIn(){return"BoardofDirectors"==this.showPopup?this.amount=this.bodbalance:this.amount=this.lpbalance},approve(){const t="BoardofDirectors"==this.showPopup?this.$contracts.DaoToken:this.$contracts.Pair;t.methods.approve(this.$contracts.TokenBiggings._address,this.amount.toBN().times(100).toFixed().toWei()).send({from:this.$address}).on("transactionHash",t=>{this.transactionState="approving"}).on("receipt",async e=>{this.allowance=(await t.methods.allowance(this.$address,this.$contracts.TokenBiggings._address).call({from:this.$address})).fromWei().toBN(),i["a"].success(this.$t("participatePledge.text9")),this.transactionState="none"}).on("error",t=>{this.transactionState="none",console.log(t)})},deposit(){if(console.log(this.showPopup),"BoardofDirectors"==this.showPopup?this.id=2:this.id=0,this.amount<=0)return i["a"].fail(this.$t("participatePledge.text10"));if(this.balance.toBN().lt(this.amount))return i["a"].fail(this.$t("participatePledge.text11"));if(this.allowance.lt(this.amount))return this.approve();const t=this.$contracts.TokenBiggings.methods.deposit(this.id,this.amount.toWei(),this.$address);t.call({from:this.$address},(e,a)=>{e||t.send({from:this.$address}).on("transactionHash",t=>{this.transactionState="trading"}).on("receipt",t=>{this.init(),this.$emit("reload"),i["a"].success(this.$t("participatePledge.text12")),this.amount="",this.transactionState="none"}).on("error",t=>{this.transactionState="none",console.log(t)})})},init(){const t=new this.$web3.BatchRequest;t.add(this.$contracts.DaoToken.methods.allowance(this.$address,this.$contracts.TokenBiggings._address).call.request({from:this.$address})),t.add(this.$contracts.DaoToken.methods.balanceOf(this.$address).call.request({from:this.$address})),t.add(this.$contracts.Pair.methods.allowance(this.$address,this.$contracts.TokenBiggings._address).call.request({from:this.$address})),t.add(this.$contracts.Pair.methods.balanceOf(this.$address).call.request({from:this.$address})),t.requestManager.sendBatch(t.requests,(t,e)=>{t||(this.bodallowance=("string"===typeof e[0]?e[0]:e[0].result).decode(["uint256"]).fromWei().toBN(),this.bodbalance=e[1].result.decode(["uint256"]).fromWei(),this.lpallowance=e[2].result.decode(["uint256"]).fromWei().toBN(),this.lpbalance=e[3].result.decode(["uint256"]).fromWei())})}}},d=c,l=d,h=(a("51f9"),a("2877")),p=Object(h["a"])(l,s,o,!1,null,"2c630092",null);e["default"]=p.exports}}]);